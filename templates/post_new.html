{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% block content %}
<body onload="getLocation()">

  <div class="card mx-auto" style="width:500px">
    <div class="card-header">
      <h1>New post</h1>
    </div>
    <div class="card-body">
      <form action="" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ form|crispy}}
      </form>
    </div>
    <div class="card-footer">
      <button class="btn btn-primary ml-2" type="submit" href="{% url 'pages:post_history' %}">Post</button>
    </div>
  </div>
  
<script>
  function getLocation() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(showPosition);
    } else {
      console.log("Geolocation is not supported by this browser.");
    }
  }
  
  function showPosition(position) {
    let lat = position.coords.latitude;
    let long = position.coords.longitude;
    document.getElementById("id_latitude").value = lat;
    document.getElementById("id_longitude").value = long;
  };
</script>
{% endblock content %}
